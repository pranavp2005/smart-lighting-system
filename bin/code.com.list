EMU8086 GENERATED LISTING. MACHINE CODE <- SOURCE.
 
code.com -- emu8086 assembler version: 4.08  
 
[ 4/23/2019  --  3:32:36 PM ] 
 
===================================================================================================
[LINE]     LOC: MACHINE CODE                          SOURCE
===================================================================================================
 
[   1]        :                                       .MODEL TINY
[   2]        :                                       
[   3]        :                                       
[   4]    0202: 00 00                                 .DATA
[   5]        :                                       PORTA equ 0000h
[   6]        :                                       PORTB equ 0002h
[   7]        :                                       PORTC equ 0004h
[   8]        :                                       CWREG equ 0006h
[   9]        :                                       
[  10]        :                                       
[  11]    0204:                                       .CODE
[  12]    0204:                                       .STARTUP
[  13]        :                                       
[  14]        :                                       
[  15]        :                                       init:   ORG 0000h
[  16]        :                                       
[  17]        :                                       ; This register will serve as internal memory and store the number of people in the room.
[  18]    0102: 00 00                                 mov dl, 00h
[  19]        :                                       
[  20]        :                                       ; Set up the PPI to read from Port A and write to Port B and Port C.
[  21]    0104: 00 00                                 mov al, 10010000b
[  22]    0106: 00 00                                 OUT CWREG, al
[  23]        :                                       
[  24]        :                                       
[  25]    0108: 00 00 00                              main:   CALL check_entry
[  26]    010B: 00 00 00                              CALL check_exit
[  27]    010E: 00 00                                 JMP main
[  28]        :                                       
[  29]        :                                       
[  30]    0110:                                       delay PROC NEAR
[  31]        :                                       ; A small timed delay. The caller should set CX before calling.
[  32]    0110: 00                                    p1:     NOP
[  33]    0111: 00                                    DEC cx
[  34]    0112: 00 00                                 JNE p1
[  35]    0114: 00                                    ret
[  36]        :                                       delay ENDP
[  37]        :                                       
[  38]        :                                       
[  39]    0115:                                       delay_db PROC NEAR
[  40]        :                                       ; A debounce delay mechanism implemented on Port A's pressure sensors (push buttons).
[  41]    0115: 00 00                                 p2:     IN al, PORTA
[  42]    0117: 00 00                                 CMP al, 0h
[  43]    0119: 00 00                                 JNE p2
[  44]    011B: 00                                    ret
[  45]        :                                       delay_db ENDP
[  46]        :                                       
[  47]        :                                       
[  48]    011C:                                       incr_cnt PROC NEAR
[  49]        :                                       ; Increase the count value and update the display.
[  50]    011C: 00 00                                 INC dl;
[  51]    011E: 00 00                                 MOV al, dl
[  52]    0120: 00 00                                 OUT PORTC, al
[  53]    0122: 00                                    ret
[  54]        :                                       incr_cnt ENDP
[  55]        :                                       
[  56]        :                                       
[  57]    0123:                                       decr_cnt PROC NEAR
[  58]        :                                       ; Decrease the count value and update the display.
[  59]    0123: 00 00                                 DEC dl;
[  60]    0125: 00 00                                 MOV al, dl
[  61]    0127: 00 00                                 OUT PORTC, al
[  62]    0129: 00                                    ret
[  63]        :                                       decr_cnt ENDP
[  64]        :                                       
[  65]        :                                       
[  66]    012A:                                       check_entry PROC NEAR
[  67]        :                                       ; Check to see if the external pressure sensor has been triggered.
[  68]    012A: 00 00                                 IN   al, PORTA
[  69]    012C: 00 00                                 CMP  al, 00000001b
[  70]    012E: 00 00                                 JNE  p5
[  71]        :                                       
[  72]        :                                       ; Wait for person to enter.
[  73]        :                                       ;MOV  CX, 06FFFh
[  74]        :                                       ;CALL delay
[  75]        :                                       
[  76]        :                                       ; Check to see if the internal pressure sensor has been triggered. Provide a small window of time for entry.
[  77]    0130: 00 00 00                              MOV  cx, 0FFFFh
[  78]    0133: 00 00                                 p3:     IN   al, PORTA
[  79]    0135: 00 00                                 CMP  al, 00000010b
[  80]    0137: 00 00                                 JE   p4
[  81]    0139: 00                                    DEC  cx
[  82]    013A: 00 00                                 JNE  p3
[  83]    013C: 00 00                                 JMP  p5
[  84]        :                                       
[  85]        :                                       ; Increase the count if both have been triggered.
[  86]    013E: 00 00 00                              p4:     CALL incr_cnt
[  87]        :                                       
[  88]    0141: 00                                    p5:     ret
[  89]        :                                       check_entry ENDP
[  90]        :                                       
[  91]        :                                       
[  92]    0142:                                       check_exit PROC NEAR
[  93]        :                                       ; Check to see if the external pressure sensor has been triggered.
[  94]    0142: 00 00                                 IN   al, PORTA
[  95]    0144: 00 00                                 CMP  al, 00000010b
[  96]    0146: 00 00                                 JNE  p8
[  97]        :                                       
[  98]        :                                       ; Wait for person to enter.
[  99]        :                                       ;MOV  CX, 06FFFh
[ 100]        :                                       ;CALL delay
[ 101]        :                                       
[ 102]        :                                       ; Check to see if the internal pressure sensor has been triggered. Provide a small window of time for entry.
[ 103]    0148: 00 00 00                              MOV  cx, 0FFFFh
[ 104]    014B: 00 00                                 p6:     IN   al, PORTA
[ 105]    014D: 00 00                                 CMP  al, 00000001b
[ 106]    014F: 00 00                                 JE   p7
[ 107]    0151: 00                                    DEC  cx
[ 108]    0152: 00 00                                 JNE  p6
[ 109]    0154: 00 00                                 JMP  p8
[ 110]        :                                       
[ 111]        :                                       ; Increase the count if both have been triggered.
[ 112]    0156: 00 00 00                              p7:     CALL decr_cnt
[ 113]        :                                       
[ 114]    0159: 00                                    p8:     ret
[ 115]        :                                       check_exit ENDP
[ 116]        :                                       
[ 117]        :                                       END
[ 118]        :                                       
 
===================================================================================================
 




===================================================================================================
